# Makefile ä½¿ç”¨æŒ‡å—

fn_cache é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„ Makefile å‘½ä»¤æ¥ç®€åŒ–å¼€å‘å·¥ä½œã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤

```bash
make help
```

### ä¸€é”®è®¾ç½®å¼€å‘ç¯å¢ƒ

```bash
make dev-setup
```

## ğŸ“‹ å‘½ä»¤åˆ†ç±»

### ğŸ”§ åŸºç¡€å‘½ä»¤

| å‘½ä»¤ | æè¿° |
|------|------|
| `make help` | æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤ |
| `make install` | å®‰è£…åŸºç¡€ä¾èµ– |
| `make install-dev` | å®‰è£…å¼€å‘ä¾èµ– |
| `make version` | æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ |

### ğŸ¨ ä»£ç è´¨é‡

| å‘½ä»¤ | æè¿° |
|------|------|
| `make format` | æ ¼å¼åŒ–ä»£ç  (black + isort) |
| `make lint` | ä»£ç æ£€æŸ¥ (flake8 + mypy) |
| `make quality` | ä»£ç è´¨é‡æ£€æŸ¥ (format + lint) |

### ğŸ§ª æµ‹è¯•

| å‘½ä»¤ | æè¿° |
|------|------|
| `make test` | è¿è¡Œæµ‹è¯• |
| `make test-cov` | è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š |

### ğŸ“š æ–‡æ¡£

| å‘½ä»¤ | æè¿° |
|------|------|
| `make docs` | æ„å»ºæ–‡æ¡£ |
| `make docs-serve` | å¯åŠ¨æ–‡æ¡£æœåŠ¡å™¨ (http://localhost:8000) |
| `make docs-clean` | æ¸…ç†æ–‡æ¡£æ„å»ºæ–‡ä»¶ |
| `make docs-install` | å®‰è£…æ–‡æ¡£ä¾èµ– |
| `make docs-build` | å®‰è£…ä¾èµ–å¹¶æ„å»ºæ–‡æ¡£ |
| `make docs-pdf` | æ„å»º PDF æ–‡æ¡£ |
| `make docs-script` | ä½¿ç”¨è„šæœ¬æ„å»ºæ–‡æ¡£ |
| `make docs-script-serve` | ä½¿ç”¨è„šæœ¬å¯åŠ¨æ–‡æ¡£æœåŠ¡å™¨ |

### ğŸ“¦ æ„å»ºå’Œå‘å¸ƒ

| å‘½ä»¤ | æè¿° |
|------|------|
| `make build` | æ„å»ºåˆ†å‘åŒ… |
| `make publish` | å‘å¸ƒåˆ° PyPI |
| `make publish-test` | å‘å¸ƒåˆ° Test PyPI |

### âœ… æ£€æŸ¥å’ŒéªŒè¯

| å‘½ä»¤ | æè¿° |
|------|------|
| `make check` | å®Œæ•´æ£€æŸ¥ (lint + test) |
| `make pre-commit` | é¢„æäº¤æ£€æŸ¥ (quality + test) |
| `make pre-publish` | å‘å¸ƒå‰æ£€æŸ¥ (clean + quality + test-cov + security-check) |
| `make security-check` | å®‰å…¨æ£€æŸ¥ |

### ğŸ› ï¸ ç»´æŠ¤

| å‘½ä»¤ | æè¿° |
|------|------|
| `make clean` | æ¸…ç†æ„å»ºæ–‡ä»¶ |
| `make update-deps` | æ›´æ–°ä¾èµ– |

### ğŸ¯ ç¤ºä¾‹å’Œå·¥å…·

| å‘½ä»¤ | æè¿° |
|------|------|
| `make example` | è¿è¡Œç¤ºä¾‹ |
| `make cli` | è¿è¡Œ CLI å·¥å…· |

## ğŸ”„ å¸¸ç”¨å·¥ä½œæµ

### æ—¥å¸¸å¼€å‘

```bash
# 1. è®¾ç½®å¼€å‘ç¯å¢ƒ
make dev-setup

# 2. ç¼–å†™ä»£ç åï¼Œè¿è¡Œè´¨é‡æ£€æŸ¥
make quality

# 3. è¿è¡Œæµ‹è¯•
make test

# 4. æäº¤å‰æ£€æŸ¥
make pre-commit
```

### æ–‡æ¡£å¼€å‘

```bash
# 1. å®‰è£…æ–‡æ¡£ä¾èµ–
make docs-install

# 2. æ„å»ºæ–‡æ¡£
make docs

# 3. å¯åŠ¨æ–‡æ¡£æœåŠ¡å™¨
make docs-serve

# 4. åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:8000
```

### å‘å¸ƒå‰å‡†å¤‡

```bash
# è¿è¡Œå®Œæ•´çš„å‘å¸ƒå‰æ£€æŸ¥
make pre-publish
```

è¿™ä¸ªå‘½ä»¤ä¼šï¼š
1. æ¸…ç†æ„å»ºæ–‡ä»¶
2. æ ¼å¼åŒ–ä»£ç 
3. è¿è¡Œä»£ç æ£€æŸ¥
4. è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
5. è¿è¡Œå®‰å…¨æ£€æŸ¥

## ğŸ›ï¸ é«˜çº§ç”¨æ³•

### ç»„åˆå‘½ä»¤

```bash
# ä»£ç è´¨é‡ + æµ‹è¯•
make quality test

# æ¸…ç† + æ„å»º
make clean build

# å®‰è£…ä¾èµ– + æ„å»ºæ–‡æ¡£
make docs-install docs
```

### ç¯å¢ƒå˜é‡

æŸäº›å‘½ä»¤æ”¯æŒç¯å¢ƒå˜é‡é…ç½®ï¼š

```bash
# è®¾ç½®æ–‡æ¡£æœåŠ¡å™¨ç«¯å£
PORT=8080 make docs-serve

# å¯ç”¨è°ƒè¯•æ¨¡å¼
FN_CACHE_DEBUG=1 make test
```

### å¹¶è¡Œæ‰§è¡Œ

æŸäº›å‘½ä»¤æ”¯æŒå¹¶è¡Œæ‰§è¡Œä»¥æé«˜é€Ÿåº¦ï¼š

```bash
# å¹¶è¡Œè¿è¡Œæµ‹è¯•
make test -j4

# å¹¶è¡Œæ ¼å¼åŒ–ä»£ç 
make format -j4
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤

å¯ä»¥åœ¨ Makefile ä¸­æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ï¼š

```makefile
# è‡ªå®šä¹‰å‘½ä»¤ç¤ºä¾‹
custom-command:
	@echo "æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤..."
	# ä½ çš„å‘½ä»¤
```

### ä¿®æ”¹ç°æœ‰å‘½ä»¤

å¯ä»¥ä¿®æ”¹ç°æœ‰å‘½ä»¤çš„è¡Œä¸ºï¼š

```makefile
# ä¿®æ”¹æµ‹è¯•å‘½ä»¤
test:
	pytest tests/ -v --tb=short
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å‘½ä»¤æœªæ‰¾åˆ°**
   ```bash
   # ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
   pwd
   ls Makefile
   ```

2. **æƒé™é—®é¢˜**
   ```bash
   # ä½¿ç”¨ sudo (å¦‚æœéœ€è¦)
   sudo make install
   ```

3. **ä¾èµ–é—®é¢˜**
   ```bash
   # æ›´æ–°ä¾èµ–
   make update-deps
   ```

4. **æ–‡æ¡£æ„å»ºå¤±è´¥**
   ```bash
   # æ¸…ç†å¹¶é‡æ–°æ„å»º
   make docs-clean
   make docs-install
   make docs
   ```

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è°ƒè¯•æ¨¡å¼ä»¥è·å–æ›´å¤šä¿¡æ¯ï¼š

```bash
# æ˜¾ç¤ºæ‰§è¡Œçš„å‘½ä»¤
make -n command

# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
make -d command

# æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯
make --debug=b command
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¼€å‘ç¯å¢ƒ](docs/development.md) - è¯¦ç»†çš„å¼€å‘ç¯å¢ƒè®¾ç½®
- [è´¡çŒ®æŒ‡å—](docs/contributing.md) - å¦‚ä½•è´¡çŒ®ä»£ç 
- [æµ‹è¯•æŒ‡å—](docs/testing.md) - æµ‹è¯•ç›¸å…³è¯´æ˜

## ğŸ”— ç›¸å…³é“¾æ¥

- [é¡¹ç›®ä¸»é¡µ](https://github.com/leowzz/fn_cache)
- [Makefile å®˜æ–¹æ–‡æ¡£](https://www.gnu.org/software/make/)
- [Python Makefile æœ€ä½³å®è·µ](https://github.com/audreyr/cookiecutter-pypackage) 